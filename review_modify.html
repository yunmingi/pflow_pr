<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>review_modify</title>
    <link href="style_review.css" rel="stylesheet" type="text/css" />
  </head>

  <body>
    <div class="container">
      <header>
        <h2>1:1 문의쓰기</h2>
        <p style="font-size: 15px">
          산업안전보건법 제 41조 시행령에 근거하여 2018년 10월 18일 부터
          산업안전보건법에 따라 고객응대근로자 보호조치를 시행하고 있습니다.
          고객응대근로자에게 폭언, 폭행 등을 하지 말아주세요.
        </p>
      </header>
      <form id="reivewForm">
        <table>
          <tr>
            <th>구매관련문의</th>
            <td>
              <input type="radio" name="option" value="배송문의" />배송문의
              <input type="radio" name="option" value="주문문의" />주문문의
              <input type="radio" name="option" value="취소문의" />취소문의
              <input type="radio" name="option" value="교환문의" />교환문의
              <input type="radio" name="option" value="환불문의" />환불문의
              <input type="radio" name="option" value="사은품문의" />사은품문의
              <input type="radio" name="option" value="입금문의" />입금문의
              <input type="radio" name="option" value="선물문의" />선물문의
            </td>
          </tr>
          <tr>
            <th>일반상담문의</th>
            <td>
              <input
                type="radio"
                name="option"
                value="회원정보문의"
              />회원정보문의
              <input
                type="radio"
                name="option"
                value="회원제도문의"
              />회원제도문의
              <input
                type="radio"
                name="option"
                value="결제방법문의"
              />결제방법문의
              <input type="radio" name="option" value="상품문의" />상품문의
              <input type="radio" name="option" value="당첨문의" />당첨문의
              <input
                type="radio"
                name="option"
                value="쿠폰/마일리지문의"
              />쿠폰/마일리지문의
            </td>
          </tr>
          <tr>
            <th>기타문의</th>
            <td>
              <input type="radio" name="option" value="시스템문의" />시스템문의
              <input type="radio" name="option" value="기타문의" />기타문의
              <input
                type="radio"
                name="option"
                value="증빙서류문의"
              />증빙서류문의
              <input type="radio" name="option" value="매장문의" />매장문의
              <input
                type="radio"
                name="option"
                value="리뷰재노출문의"
              />리뷰재노출문의
            </td>
          </tr>
          <!-- 숨겨진 주문번호 조회 영역 -->
          <tr class="hidden-row" id="order-row">
            <th>주문번호</th>
            <td>
              <input
                type="text"
                style="width: 300px"
                id="order-inquery"
                name="order-inquery"
                placeholder="주문번호를 입력하세요."
              />
              <button type="button" class="modal-open">주문번호조회</button>
            </td>
          </tr>
          <tr class="hidden-row" id="order-info-row">
            <th>주문정보</th>
            <td>조회선택하면 나오는 주문정보</td>
          </tr>

          <!-- 숨겨진 상품번호 조회 영역 -->
          <tr class="hidden-row" id="product-row">
            <th>문의상품</th>
            <td>
              <input
                type="text"
                style="width: 300px"
                id="product-inquery"
                name="product-inquery"
                placeholder="상품번호를 입력하세요."
              />
              <button type="button" class="modal-open">상품번호조회</button>
            </td>
          </tr>
          <tr class="hidden-row" id="product-info-row">
            <th>상품정보</th>
            <td>조회선택하면 나오는 상품정보</td>
          </tr>

          <tr class = user-info>
            <th>성명</th>
            <td id="name">
             <span id = "name">(유저 이름)</span> 
            </td>
          </tr>
          <tr>
            <th>아이디</th>
            <td>
            <span id = "id">(유저 아이디)</span>  
            </td>
          </tr>
          <tr>
            <th>이메일</th>
            <td >
              <span id = "email">
              (유저 이메일)
            </span>
              <button onclick="location.href= 추후페이지생성">
                이메일 변경
              </button>
            </td>
          </tr>

          <tr>
            <th>제목</th>
            <td>
              <input
                id="title"
                type="text"
                name="title"

                style="width: 300px"
                placeholder="제목을 입력하세요."
                required
              />
              <input id="chk_info" type="checkbox" name="chk_info" value="chk_info" />
              이메일 받기
            </td>
          </tr>

          <tr>
            <th>내용</th>
            <td>
              <textarea
                id="content"
                name="content"
                value="content"
                rows="5"
                placeholder="내용을 입력하세요"
                required
              ></textarea>
            </td>
          </tr>
          <tr>
            <th>사진첨부</th>
            <td>
              <div class="file-upload-container">
              <div class="preview-container">
                <button class="cancel-button" id="cancel-button">x</button>
                <img
                  id="preview1"
                  class="preview-image"
                  src="#"
                  alt="미리보기 1"
                />
                <img
                  id="preview2"
                  class="preview-image"
                  src="#"
                  alt="미리보기 2"
                />
              </div>
              <div class="filebox">
                <label for="ex_file">+</label>
                <input type="file" id="ex_file" name="ex_file" value="첨부사진" accept="image/*" multiple />
              </div>
              <div id="file-name-display"></div>
              <div class="filered">
                <ul>
                  <li style="font-size: 12px">
                    상품 불량 및 오배송의 경우, 해당 제품 사진을 등록
                    부탁드립니다.
                  </li>
                  <li style="font-size: 12px; color: red">
                    파일명은 영문만 가능하며, 파일당 최대 10MB의 용량 제한이
                    있습니다.
                  </li>
                  <li style="font-size: 12px">
                    가로사이즈가 450pixel을 초과하는 경우 450픽셀로 조정됩니다.
                  </li>
                  <li style="font-size: 12px">
                    첨부파일은 최대 2개까지 등록가능합니다.
                  </li>
                </ul>
              </div>
            </td>
          </tr>
        </table>

        <div class="submit_btn_box" >
          
          <input type="submit" id="submit" value="등록하기" onsubmit="submitForm()"/>
        </div>
    <!--HOME버튼인데 그냥 유저정보 있는 페이지로 이동...-->  
        <button class="home-btn" onclick="window.location.href = 'user.html';">HOME</button>
      </form>
    </div>

    <!--주문조회를 위한 모달창 영역-->
    <div class="modal--bg hidden">
      <div class="modal">
        <p class="modal-text">주문조회를 하는 Modal 영역</p>
        <button class="modal-close">X</button>
      </div>
    </div>

    <!-- JavaScript -->

    <script>
      // 이미지 업로드 및 미리보기 기능

      const fileInput = document.getElementById('ex_file');
      const preview1 = document.getElementById('preview1');
      const preview2 = document.getElementById('preview2');

      
      fileInput.addEventListener('change', function(event) {
      const files = event.target.files;

      // 미리보기 초기화
      preview1.style.display = 'none';
      preview2.style.display = 'none';

    if (files.length > 0) {
      const reader1 = new FileReader();
      reader1.onload = function(e) {
      preview1.src = e.target.result;
      preview1.style.display = 'block';
      }
      reader1.readAsDataURL(files[0]);
    }

    if (files.length > 1) {
      const reader2 = new FileReader();
      reader2.onload = function(e) {
      preview2.src = e.target.result;
      preview2.style.display = 'block';
      }
      reader2.readAsDataURL(files[1]);
    }

    // 2개 이상의 파일이 선택된 경우 경고
    if (files.length > 2) {
      alert('최대 2개의 파일만 첨부할 수 있습니다. 처음 2개의 파일만 선택됩니다.');
    }
  });


        
      // 라디오 버튼 클릭 시 펼치는 함수
      function toggleAccordion(selectedOption) {
        // 모든 숨겨진 행을 선택
        const hiddenRows = document.querySelectorAll(".hidden-row");

        // 숨겨진 행들을 기본적으로 모두 숨김
        hiddenRows.forEach((row) => {
          row.style.display = "none";
        });

        // 선택된 옵션에 따라 특정 행을 표시
        if (
          selectedOption === "배송문의" ||
          selectedOption === "주문문의" ||
          selectedOption === "취소문의" ||
          selectedOption === "교환문의" ||
          selectedOption === "환불문의" ||
          selectedOption === "사은품문의" ||
          selectedOption === "입금문의" ||
          selectedOption === "선물문의"
        ) {
          document.getElementById("order-row").style.display = "table-row";
          document.getElementById("order-info-row").style.display = "table-row";
        } else if (selectedOption === "상품문의") {
          document.getElementById("product-row").style.display = "table-row";
          document.getElementById("product-info-row").style.display =
            "table-row";
        }
      }

      // 모든 라디오 버튼에 대한 이벤트 리스너 추가
      const radioButtons = document.querySelectorAll('input[type="radio"]');
      radioButtons.forEach((radio) => {
        radio.addEventListener("click", function () {
          toggleAccordion(this.value);
        });
      });

     
// 모달창을 여는함수, 닫는 함수 생성
      const openBtn = document.querySelector(".modal-open");
      const closeBtn = document.querySelector(".modal-close");
      const modal = document.querySelector(".modal--bg");
// 클릭이벤트 발생시 모달 보여짐, 모달창 닫힘 
      openBtn.addEventListener("click", showModal);
      closeBtn.addEventListener("click", closeModal);
// 모달창이 보이는 함수 생성 
      function showModal() {
        modal.classList.remove("hidden");
        modal.classList.add("visible");
      }
// 모달창 닫는 함수 생성
      function closeModal() {
        modal.classList.add("hidden");
        modal.classList.remove("visible");
      }

      // 유저 기본정보 불러오기 (JavaScript를 사용한 fetch API로 HTML 페이지 가져오기)
      function loadUserInfo() {
            fetch('user.html')  // 'user.html' 파일을 요청
                .then(response => response.text())  // 응답을 텍스트로 변환
                .then(data => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(data, 'text/html');
                    
                    // 각각의 정보를 가져오기
                    const userName = doc.getElementById('name');
                    const userId = doc.getElementById('id');
                    const userEmail = doc.getElementById('email');
                    
                    // 가져온 데이터를 main.html의 지정된 위치에 삽입
                    // id값으로 데이터 불러옴
                    if (userName) {
                        document.getElementById('name').textContent = userName.textContent;
                    } else {
                        console.error('사용자 이름 요소를 찾을 수 없습니다.');
                    }

                    if (userId) {
                        document.getElementById('id').textContent = userId.textContent;
                    } else {
                        console.error('사용자 ID 요소를 찾을 수 없습니다.');
                    }

                    if (userEmail) {
                        document.getElementById('email').textContent = userEmail.textContent;
                    } else {
                        console.error('사용자 이메일 요소를 찾을 수 없습니다.');
                    }
                })
                .catch(error => console.error('HTML 가져오기 오류:', error));
        }

        // 함수 호출하여 데이터를 가져와서 삽입
        loadUserInfo();
    </script>
    <script src="../js/serverForm.js" ></script>
  </body>
</html>



